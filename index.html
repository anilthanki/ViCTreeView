<html>
<head>
    <meta charset="utf-8">

    <script src="jquery/js/jquery-1.11.2.min.js"></script>

    <script src="jquery/js/jquery-ui-1.11.2.js"></script>

    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

    <script src="scripts/d3.v3.min.js"></script>
    
    <script src="scripts/phylotree.js"></script>

    <script src="scripts/newick-to-json.js"></script>

    <script src="scripts/underscore-min.js"></script>

    <link rel="stylesheet" href="jquery/css/smoothness/jquery-ui-1.11.2.css" />

    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">

    <link href="font-awesome-4.5.0/css/font-awesome.css" rel="stylesheet">

    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css">

    <link href="css/phylotree.css" rel="stylesheet">

    <script>

        $.ajax({
            type: "GET",
            url: "data/tree/txid40120_tree.nhx",
            dataType: "text",
            success: function (treeString) {
                var res = d3_phylotree_newick_parser ( treeString )
                var species;
                var labels = {}
                d3.csv("data/matrix/txid40120_matrix.csv")
                    .get(function(error, rows) { 
                        species = rows;
                        console.log("species")
                        console.log(species)

                        d3.csv("data/matrix/txid40120_label_matrix.csv")
                            .get(function(error, rows) { 
                                for(i in rows){
                                    labels[rows[i].Protein_GI] = rows[i]
                                }
                                var tree1 = new Tree(species, labels, res, "#tree_container");
                                tree1.drawTree()
                            });
                        });
                }       
            });

    
    function changeGenome(file, matrix, label){
            console.log(file)

            $.ajax({
                type: "GET",
                url: file,
                dataType: "text",
                success: function (treeString) {
                    var res = d3_phylotree_newick_parser ( treeString )
                    var species;
                    var labels = {}
                    d3.csv(matrix)
                        .get(function(error, rows) { 
                            species = rows;
                            console.log("species")
                            console.log(species)

                            d3.csv(label)
                                .get(function(error, rows) { 
                                    for(i in rows){
                                        labels[rows[i].Protein_GI] = rows[i]
                                    }
                                    var tree1 = new Tree(species, labels, res, "#tree_container");
                                    tree1.drawTree()
                                });
                            });
                    }       
                })
    }
$( document ).ready(function() {
    $(function() {
        
    });
});

    </script>
</head>

<body style = 'padding-top: 100px;'>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container-fluid">

            <div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle ui-link" href="#">Examples <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li id="example_txid40120" onclick="changeGenome('data/tree/txid40120_tree.nhx','data/matrix/txid40120_matrix.csv','data/matrix/txid40120_label_matrix.csv')" ><a href="#" class="ui-link">txid40120</a></li>
                            <li id="example_denso" onclick="changeGenome('data/tree/denso_tree.nhx','data/matrix/NS1_clustalo_dist_mat.csv','data/matrix/txid40120_label_matrix.csv')" ><a href="#" class="ui-link">Densovirinae_tree</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="navbar-brand"> 

                    <table>
                        <tbody>
                            <tr>
                                <td> 
                                    <button type="button" class="btn btn-default btn-sm ui-btn ui-shadow ui-corner-all" id="sort_ascending" title="Sort deepest clades to the bototm">
                                        <i class="fa fa-expand"></i>
                                    </button>
                                </td>
                               <td>
                                    <button type="button" class="btn btn-default btn-sm ui-btn ui-shadow ui-corner-all" id="sort_descending" title="Sort deepsest clades to the top">
                                        <i class="fa fa-compress"></i>
                                    </button>
                                </td>
                                <td>
                                    <button type="button" class="btn btn-default btn-sm ui-btn ui-shadow ui-corner-all" id="change_tree" title="Sort deepsest clades to the top">
                                        <i class="fa fa-usb"></i>
                                    </button>
                                </td> 
                                <td> 
                                    <button title="Sort deepsest clades to the top" class="btn btn-default btn-sm ui-btn ui-shadow ui-corner-all" type="button" id="save">
                                        <i class="fa fa-camera"></i>
                                    </button>
                                </td>
                                <td> 
                                    <div id="label_list">
                                        <select  name='label_list'>
                                            <option value='Description'>Description</option>
                                            <option value='Genome_Accession'>Genome_Accession</option>
                                            <option value='Genus'>Genus</option>
                                            <option value='Lineage'>Lineage</option>
                                            <option value='Nucleotide_GI'>Nucleotide_GI</option>
                                            <option value='Protein_GI' selected>Protein_GI</option>
                                            <option value='Species_Name'>Species_Name</option>
                                            <!-- <option value='URL'>URL</option> -->
                                        </select>
                                    </div>    
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <table width="100%">
            <tbody>
                <tr>
                    <td width="20%">
                        <label for="amount" style="color:gray">Distance:</label>
                        <input type="text" name="percentage" id="percentage" readonly="" style="border:0; font-weight:bold;"> 
                    </td>
                    <td width="80%">
                        <div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="slider" style="width:80%;"><span style="left: 0%;" class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span></div>
                    </td>
                </tr>
            </tbody>
        </table>
    </nav>


    <div class = 'container' id = "main_display">
        <div class = 'row'>
            <div class = 'col-md-12'>
                <div id = 'tree_container' class = 'tree-widget'>
                </div>
            </div>
        </div>
    </div>

    <canvas id="canvas" width="1000px" height="600px">
    </canvas> 
</body>
</html>